{
    "author": "Lukas Reiter", 
    "plugins": [
        4
    ], 
    "uuid": "cd9f9437-da1d-41b9-9660-4e3575268f62", 
    "version": "v1.1", 
    "script": "\"\"\"\nThis script\na) silently drops HTTP requests to URLs that are specified in list session[\"filter\"] (see Lines 13+) or\nb) silently forwards (without proxy interception) HTTP requests to hosts that are specified in list\r\nsession[\"ignore\"] (see Lines 23+) and which were issued by Burp Suite Proxy tool\r\n(IBurpExtenderCallbacks.TOOL_PROXY).\n\"\"\"\nimport re\nfrom burp import IInterceptedProxyMessage\nfrom burp import IBurpExtenderCallbacks\r\n\n# Do the initial setup\nif ref == 1 or \"filter\" not in session or \"ignore\" not in session:\n\tsession[\"filter\"] = [re.compile(\"^https?://(.+\\.)?mozilla\\.((com)|(org)|(net))(:\\d+)?.*$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^https?://(.+\\.)?firefox\\.((com)|(org)|(net))(:\\d+)?.*$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^https?://(.+\\.)?google\\.((com)|(org)|(net))(:\\d+)?.*$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^https?://(.+\\.)?google-analytics\\.((com)|(org)|(net))(:\\d+)?.*$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^https?://(.+\\.)?yahoo\\.((com)|(org)|(net))(:\\d+)?.*$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^https?://(.+\\.)?goo\\.gl(:\\d+)?.*$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^https?://(.+\\.)?googleapis\\.((com)|(org)|(net))(:\\d+)?.*$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^https?://(.+\\.)?gstatic\\.((com)|(org)|(net))(:\\d+)?.*$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^https?://ciscobinary\\.openh264\\.org(:\\d+)?.*$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^https?://ocsp\\.apple\\.com(:\\d+)?.*$\", re.IGNORECASE)]\n\tsession[\"ignore\"] = []\r\n\n# Process each HTTP request issued by the Burp Suite Proxy tool\nif is_request and plugin_id in [IBurpExtenderCallbacks.TOOL_PROXY]:\n\turl_str = unicode(url)\n\tfor filter in session[\"filter\"]:\n\t\tif filter.match(url_str):\n\t\t\tprint(\"Dropping: {}\".format(url_str))\n\t\t\tproxy_message_info.setInterceptAction(IInterceptedProxyMessage.ACTION_DROP)\n\tfor filter in session[\"ignore\"]:\n\t\tif filter.match(url_str):\n\t\t\tprint(\"Ignoring url: {}\". format(url_str))\n\t\t\tproxy_message_info.setInterceptAction(IInterceptedProxyMessage.ACTION_DONT_INTERCEPT)", 
    "name": "Template Script to Silently Drop Unwanted Communication"
}